#include "dsplib/window.h"
#include "tests_common.h"

using namespace dsplib;

//-------------------------------------------------------------------------------------------------
TEST(Window, Gauss) {
    arr_real x1 = window::gauss(16, 2.5);
    arr_real x2 = {0.0439, 0.0956, 0.1863, 0.3247, 0.5063, 0.7066, 0.8825, 0.9862,
                   0.9862, 0.8825, 0.7066, 0.5063, 0.3247, 0.1863, 0.0956, 0.0439};
    ASSERT_EQ_ARR_REAL(x1, x2, 1e-3);
}

//-------------------------------------------------------------------------------------------------
TEST(Window, Blackmanharris) {
    {
        arr_real x1 = window::blackmanharris(16);
        arr_real x2 = {0.0001, 0.0036, 0.0267, 0.1030, 0.2680, 0.5206, 0.7938, 0.9749,
                       0.9749, 0.7938, 0.5206, 0.2680, 0.1030, 0.0267, 0.0036, 0.0001};
        ASSERT_EQ_ARR_REAL(x1, x2, 1e-4);
    }

    {
        arr_real x1 = window::blackmanharris(15, true);
        arr_real x2 = {0.0001, 0.0036, 0.0267, 0.1030, 0.2680, 0.5206, 0.7938, 0.9749,
                       0.9749, 0.7938, 0.5206, 0.2680, 0.1030, 0.0267, 0.0036};
        ASSERT_EQ_ARR_REAL(x1, x2, 1e-4);
    }
}

//-------------------------------------------------------------------------------------------------
TEST(Window, Kaiser) {
    {
        arr_real x1 = window::kaiser(32, 1);
        arr_real x2 = {0.789848314825112, 0.814698491938938, 0.838242773832630, 0.860411532965690, 0.881139078670412,
                       0.900363879028368, 0.918028768889845, 0.934081143290337, 0.948473135570260, 0.961161779558600,
                       0.972109155238211, 0.981282517369581, 0.988654406610948, 0.994202742735461, 0.997910899610286,
                       0.999767761668133, 0.999767761668133, 0.997910899610286, 0.994202742735461, 0.988654406610948,
                       0.981282517369581, 0.972109155238211, 0.961161779558600, 0.948473135570260, 0.934081143290337,
                       0.918028768889845, 0.900363879028368, 0.881139078670412, 0.860411532965690, 0.838242773832630,
                       0.814698491938938, 0.789848314825112};
        ASSERT_EQ_ARR_REAL(x1, x2, 1e-7);
    }
    {
        arr_real x1 = window::kaiser(17, 10);
        arr_real x2 = {0.000355149374724085, 0.00839739195551166, 0.0419398003277483,
                       0.126702801536292,    0.282059620822732,   0.501196800507225,
                       0.740117133443384,    0.928314456667877,   1,
                       0.928314456667877,    0.740117133443384,   0.501196800507225,
                       0.282059620822732,    0.126702801536292,   0.0419398003277483,
                       0.00839739195551166,  0.000355149374724085};
        ASSERT_EQ_ARR_REAL(x1, x2, 1e-7);
    }
}