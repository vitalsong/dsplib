#include "dsplib/window.h"
#include "tests_common.h"

using namespace dsplib;

//-------------------------------------------------------------------------------------------------
TEST(Window, Gauss) {
    arr_real x1 = window::gauss(16, 2.5);
    arr_real x2 = {0.0439, 0.0956, 0.1863, 0.3247, 0.5063, 0.7066, 0.8825, 0.9862,
                   0.9862, 0.8825, 0.7066, 0.5063, 0.3247, 0.1863, 0.0956, 0.0439};
    ASSERT_EQ_ARR_REAL(x1, x2, 1e-3);
}

//-------------------------------------------------------------------------------------------------
TEST(Window, Blackmanharris) {
    {
        arr_real x1 = window::blackmanharris(16);
        arr_real x2 = {0.0001, 0.0036, 0.0267, 0.1030, 0.2680, 0.5206, 0.7938, 0.9749,
                       0.9749, 0.7938, 0.5206, 0.2680, 0.1030, 0.0267, 0.0036, 0.0001};
        ASSERT_EQ_ARR_REAL(x1, x2, 1e-4);
    }

    {
        arr_real x1 = window::blackmanharris(15, true);
        arr_real x2 = {0.0001, 0.0036, 0.0267, 0.1030, 0.2680, 0.5206, 0.7938, 0.9749,
                       0.9749, 0.7938, 0.5206, 0.2680, 0.1030, 0.0267, 0.0036};
        ASSERT_EQ_ARR_REAL(x1, x2, 1e-4);
    }
}